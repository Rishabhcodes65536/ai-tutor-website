<!-- views/answer.ejs -->
<%- include("./partials/header.ejs")%>
</head>
<body>
<section class="d-flex align-items-stretch">
<script>
function goBack() {
        console.log("back button clicked")
        window.history.back();
}
</script>
<%- include("./partials/side_navbar.ejs")%>

<div class="container question-content-wrapper">
    <div class="top-bar d-flex align-items-center  questionheader justify-content-between">
            <h1 class="title-question">Question on <%= topic %></h1>
            
        <a href="/topic/answer" class="btn btn-outline-secondary">Back to topic</a>
    </div>
    <div class="answer_container">
        <form class="form" method="post">
    <input type="hidden" id="question" name="question" value="<%= data.question %>">
    <input type="hidden" id="marks" name="marks" value="<%= data.marks %>">
    <input type="hidden" id="topic" name="topic" value="<%= topic %>">
    <h1 class="title"><%= data.question %></h1>
    <% if(!locals.abcd) { %>
    <label for="answer" class="form-label">Steps:</label>
    <textarea id="answer" name="solution" rows="5" cols="50" class="Input-Box" placeholder="Enter your answer here" onkeypress="handleKeyPress(event)"></textarea>
    <label for="final_answer" class="form-label">Final Answer:</label>
    <textarea id="final_answer" name="final_answer" rows="2" cols="50" class="Input-Box-Final" placeholder="Enter your answer here" onkeypress="handleKeyPress(event)"></textarea>
     <div class="container">
        <!-- Buttons for integration, differentiation, and exponential -->
        <label for="answer" class="form-label">Special Symbols:</label>
        <button type="button" onclick="appendToAnswer('âˆ«')">âˆ«</button>
        <button type="button" onclick="appendToAnswer('d/dx')">d/dx</button>
        <button type="button" onclick="appendToAnswer('e^')">e^</button>
        <button type="button" onclick="appendToAnswer('âˆš')">âˆš</button>
        <button type="button" onclick="appendToAnswer('âˆ›')">âˆ›</button>
    </div>
    <button type="submit" class="btn btn-primary submit-btn">Submit</button>
    <% } %>
            <h3 class="marks">Marks: <%= data.marks %></h3>
        </form>
        <% if(locals.abcd){%>

            <%if(data.marks==abcd.response.marks_awarded_to_student){%>
                <div class="alert alert-success" role="alert">
                    Correct Answer Hoorah ðŸ¥³!!
                </div>
                <div class="marks_awarded">Marks awarded:<%=abcd.response.marks_awarded_to_student%></div>
                <div class="feedback">
                <div class="api-feedback"><%-abcd.response.feedback%></div>
                <div class="statement">The answer you gave was <%-user_solution%></div>
                </div>
                
            <%} else{%>
            <div class="alert alert-danger" role="alert">
                    Wrong Answer ðŸ˜”!!
                <div class="marks_awarded">Marks awarded:<%=abcd.response.marks_awarded_to_student%></div>
                <div class="feedback"><%-abcd.response.feedback%></div>
                <div class="statement">The solution steps you gave was <%-user_solution%></div>
                <div class="statement">Your final answer was <%-final_answer%></div>

            </div>
            <%}%>
            <button class="custom-btn retry-btn" onclick="goBack()">Retry</button>
            <a class="custom-btn next-ques" role="button" href="../answer?topic=<%=topic%>">Next question<i class="bi bi-arrow-right-short"></i></a>
        <%}%>
    </div>
</div>
</section>
</body>
</html>



<script src="https://code.jquery.com/jquery-3.4.1.slim.min.js" integrity="sha384-J6qa4849blE2+poT4WnyKhv5vZF5SrPo0iEjwBvKU7imGFAV0wwj1yYfoRSJoZ+n" crossorigin="anonymous"></script>
<script>
    // Function to append symbols to the answer textarea
    function appendToAnswer(symbol) {
    var answerTextarea = document.getElementById('answer');
    var cursorPosition = answerTextarea.selectionStart;
    var answerText = answerTextarea.value;
    var newText = answerText.substring(0, cursorPosition) + symbol + answerText.substring(cursorPosition);
    answerTextarea.value = newText;
    }
    // Function to append a derivative box
    function appendDerivativeBox() {
    var answerDiv = document.getElementById('answer');
    var derivativeBox = document.createElement('span');
    derivativeBox.className = 'derivative-box';
    derivativeBox.contentEditable = true;
    derivativeBox.style.border = '1px solid black';
    derivativeBox.style.padding = '2px';
    derivativeBox.innerHTML = '&boxh;';
    answerDiv.appendChild(derivativeBox);
}
$(document).ready(function() {
     $("#addDerivativeButton").click(function() {
        var numeratorBox = $("<div>", {
            class: "numerator-box derivative-box",
            contenteditable: true,
            placeholder: "Numerator"
        });

        var denominatorBox = $("<div>", {
            class: "denominator-box derivative-box",
            contenteditable: true,
            placeholder: "Denominator"
        });
        $("#answer").append("d/d").append(numeratorBox).append(denominatorBox);
    });
});




</script>

<%- include("./partials/footer.ejs") %>
